{
  "swagger" : "2.0",
  "info" : {
    "description" : "No description",
    "version" : "0.1.0",
    "title" : "Ploints App API",
    "contact" : { }
  },
  "host" : "virtserver.swaggerhub.com",
  "basePath" : "/Ploints/api/0.1.0",
  "schemes" : [ "https" ],
  "consumes" : [ "application/json" ],
  "produces" : [ "application/json" ],
  "security" : [ {
    "API key" : [ ]
  }, {
    "JWT" : [ ]
  } ],
  "paths" : {
    "/token" : {
      "post" : {
        "summary" : "Authentication manager",
        "description" : "Gets new token",
        "consumes" : [ ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "type" : "object"
          },
          "x-examples" : {
            "application/json" : "{\"username\":\"inigo@ploints.com\",\"password\":\"contraseña\",\"deviceid\":\"239rf2hf4029h8f249\"}"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "schema" : {
              "$ref" : "#/definitions/UserToken"
            }
          },
          "401" : {
            "description" : "Invalid user credentials",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Invalid client application credentials (Authorization header)",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        },
        "security" : [ {
          "API key" : [ ]
        } ]
      },
      "put" : {
        "summary" : "Refresh token",
        "consumes" : [ ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "$ref" : "#/definitions/UserToken"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "schema" : {
              "$ref" : "#/definitions/UserToken"
            }
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Invalid client application credentials (Authorization header)",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      },
      "delete" : {
        "summary" : "Expire token",
        "parameters" : [ {
          "name" : "usertoken",
          "in" : "query",
          "description" : "JSON Web Token (https://jwt.io/)\n\n{\n  \"alg\": \"HS256\",\n  \"typ\": \"JWT\"\n}\n\n{\n  \"sub\": \"inigo@ploints.com\",\n  \"name\": \"Iñigo\",\n  \"exp\": 1577833200,\n  \"userid\":\"00000000-0000-0000-0000-000000000000\",\n  \"usertype\":\"user\",\n\t\"baseURL\":\"https://virtserver.swaggerhub.com/Ploints/api/0.1.0\"\n}\n\nHMACSHA256(\n  base64UrlEncode(header) + \".\" +\n  base64UrlEncode(payload),\n  \"AC508B59-DB7F-4CFC-BAE5-A118E249D759\"\n)\n\n",
          "required" : false,
          "type" : "string",
          "x-example" : "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJpbmlnb0BwbG9pbnRzLmNvbSIsIm5hbWUiOiJJw7FpZ28iLCJleHAiOjE1Nzc4MzMyMDAsInVzZXJpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInVzZXJ0eXBlIjoidXNlciIsImJhc2VVUkwiOiJodHRwczovL3ZpcnRzZXJ2ZXIuc3dhZ2dlcmh1Yi5jb20vUGxvaW50cy9hcGkvMC4xLjAifQ.894p0qs_1BRi84UgfDIPEuToEehxXLj_CFvgMwRHM_s"
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200"
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Invalid client application credentials (Authorization header)",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/users/profiles/{userid}" : {
      "get" : {
        "summary" : "Gets de user profile",
        "parameters" : [ {
          "name" : "userid",
          "in" : "path",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "schema" : {
              "$ref" : "#/definitions/User"
            }
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Token and userid don’t match or not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      },
      "put" : {
        "summary" : "Updates the user profile",
        "consumes" : [ ],
        "parameters" : [ {
          "name" : "userid",
          "in" : "path",
          "required" : true,
          "type" : "string"
        }, {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "$ref" : "#/definitions/User"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200"
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Token and userid don’t match or not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      },
      "patch" : {
        "summary" : "Partial update of user profile (password or others)",
        "consumes" : [ ],
        "parameters" : [ {
          "name" : "userid",
          "in" : "path",
          "required" : true,
          "type" : "string"
        }, {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "type" : "object"
          },
          "x-examples" : {
            "application/json" : "{\n\"newpassword\":\"nuevacontraseña\"\n}"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200"
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Token and userid don’t match or not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/users/profiles" : {
      "post" : {
        "summary" : "Creates new user profile",
        "consumes" : [ ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "$ref" : "#/definitions/User"
          }
        } ],
        "responses" : {
          "201" : {
            "description" : "Status 201",
            "schema" : {
              "$ref" : "#/definitions/User"
            }
          },
          "403" : {
            "description" : "Invalid client application credentials (Authorization header)",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        },
        "security" : [ {
          "API key" : [ ]
        } ]
      }
    },
    "/users/profiles/verifycode" : {
      "post" : {
        "summary" : "Sends code to verify user's email",
        "consumes" : [ ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "type" : "object"
          },
          "x-examples" : {
            "application/json" : "{\"email\":\"inigo@ploints.com\",\"verifycode\":\"HDOK25HH\"}"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200"
          },
          "401" : {
            "description" : "Invalid control code",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Invalid client application credentials (Authorization header)",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        },
        "security" : [ {
          "API key" : [ ]
        } ]
      }
    },
    "/users/resetpassword" : {
      "post" : {
        "summary" : "Reset password system (email)",
        "description" : "The User body may have only the newpassword node",
        "consumes" : [ ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "required" : true,
          "schema" : {
            "type" : "object"
          },
          "x-examples" : {
            "application/json" : "{\"email\":\"inigo@ploints.com\"}"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200"
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Token and userid don’t match or not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/user/points/{userid}" : {
      "get" : {
        "summary" : "Gets user points and points partners detail",
        "parameters" : [ {
          "name" : "userid",
          "in" : "path",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "schema" : {
              "$ref" : "#/definitions/UserPoints"
            }
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Token and userid don’t match or not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/cardpartners" : {
      "get" : {
        "summary" : "Gets list of card partners info",
        "parameters" : [ ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "examples" : {
              "application/json" : "[\n\t{\n\t\t\"cardpartnerid\":\"7EE69445-5835-497F-B1FD-71982643F264\",\n\t\t\"cardpartnername\":\"Amazon\",\n\t\t\"cardpartnericon\":\"https://null.com/amazon.png\",\n\t\t\"cardpartnercard\":\"https://null.com/amazon_card.png\"\n\t},\n\t{\n\t\t\"cardpartnerid\":\"0AA3F367-617A-4417-9288-440DBAD41A71\",\n\t\t\"cardpartnername\":\"Apple Store\",\n\t\t\"cardpartnericon\":\"https://null.com/amazon.png\",\n\t\t\"cardpartnercard\":\"https://null.com/amazon_card.png\"\n\t},\n\t{\n\t\t\"cardpartnerid\":\"8697C44B-E21E-48B7-A490-B8DEB6CA8C3E\",\n\t\t\"cardpartnername\":\"Ikea\",\n\t\t\"cardpartnericon\":\"https://null.com/amazon.png\",\n\t\t\"cardpartnercard\":\"https://null.com/amazon_card.png\"\n\t},\n]\n"
            },
            "schema" : {
              "type" : "array",
              "items" : {
                "$ref" : "#/definitions/CardPartner"
              }
            }
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/poinstpartners" : {
      "get" : {
        "summary" : "Gets the list of point partners available for the user",
        "parameters" : [ {
          "name" : "connected",
          "in" : "query",
          "description" : "optional filter (yes/no)",
          "required" : false,
          "type" : "string",
          "x-example" : "yes"
        }, {
          "name" : "type",
          "in" : "query",
          "description" : "optional filter (pull (connected from app) / push (push from external site))",
          "required" : false,
          "type" : "string",
          "x-example" : "pull"
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "examples" : {
              "application/json" : "[\n\t{\n\t\t\"pointpartnerid\":\"0645a49c-32c2-4716-831d-d02a22359268\",\n\t\t\"pointpartnername\":\"Iberia Plus\",\n\t\t\"pointpartnericon\":\"https://s3.amazonaws.com/com.ploints.firstbucket/content/images/iberia-plus-logo.png\",\n\t\t\"connected\":\"no\",\n\t\t\"type\":\"pull\"\n\t},\n\t{\n\t\t\"pointpartnerid\":\"afe2d434-9351-465c-85ed-92cb6f9911ee\",\n\t\t\"pointpartnername\":\"Cabify\",\n\t\t\"pointpartnericon\":\"https://s3.amazonaws.com/com.ploints.firstbucket/content/images/cabify-logo.png\",\n\t\t\"connected\":\"yes\",\n\t\t\"type\":\"pull\",\n\t\t\"pointsinpartners\":14000\n\t},\n\t{\n\t\t\"pointpartnerid\":\"51fb160b-81a9-41b2-8d63-860f1c6d1446\",\n\t\t\"pointpartnername\":\"NH Rewards\",\n\t\t\"pointpartnericon\":\"https://s3.amazonaws.com/com.ploints.firstbucket/content/images/nh-logo.png\",\n\t\t\"connected\":\"no\",\n\t\t\"type\":\"push\",\n\t\t\"pointpartnerurl\":\"https://www.nh-hoteles.es/nhrewards\"\n\t}\n]"
            },
            "schema" : {
              "type" : "array",
              "items" : {
                "$ref" : "#/definitions/PointsPartner"
              }
            }
          },
          "401" : {
            "description" : "Invalid token",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          },
          "403" : {
            "description" : "Not allowed for this user",
            "schema" : {
              "$ref" : "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/cardpartners/{cardpartnerid}" : {
      "get" : {
        "summary" : "Gets extended info on card partner",
        "parameters" : [ {
          "name" : "cardpartnerid",
          "in" : "path",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "Status 200",
            "schema" : {
              "$ref" : "#/definitions/CardPartner"
            }
          },
          "401" : {
            "description" : "Invalid token"
          },
          "403" : {
            "description" : "Not allowed for this user"
          }
        }
      }
    }
  },
  "securityDefinitions" : {
    "API key" : {
      "type" : "apiKey",
      "name" : "ApiKey",
      "in" : "header"
    },
    "JWT" : {
      "type" : "apiKey",
      "name" : "Authorization",
      "in" : "header"
    }
  },
  "definitions" : {
    "ErrorResponse" : {
      "type" : "object",
      "properties" : {
        "errorcode" : {
          "type" : "number"
        },
        "errormessage" : {
          "type" : "string"
        },
        "errormessagedetail" : {
          "type" : "string"
        }
      },
      "example" : "{\r\n    \"errorcode\":1\r\n    ,\"errormessage\":\"Invalid user token\"\r\n    ,\"errormessagedetail\":\"Helpful info for developer\"\r\n}"
    },
    "User" : {
      "type" : "object",
      "properties" : {
        "userid" : {
          "type" : "string"
        },
        "name" : {
          "type" : "string"
        },
        "lastname" : {
          "type" : "string"
        },
        "mobile" : {
          "type" : "string"
        },
        "email" : {
          "type" : "string"
        },
        "postalcode" : {
          "type" : "number"
        },
        "genderid" : {
          "type" : "number"
        },
        "birthdate" : {
          "type" : "string"
        },
        "newpassword" : {
          "type" : "object",
          "properties" : { }
        },
        "acceptcommercial" : {
          "type" : "boolean"
        },
        "acceptterms" : {
          "type" : "boolean"
        },
        "sociallogin" : {
          "$ref" : "#/definitions/User_sociallogin"
        }
      },
      "example" : "{\r\n\"userid\":\"00000000-0000-0000-0000-000000000000\"\r\n,\"name\":\"Iñigo\"\r\n,\"lastname\":\"Mingo Toral\"\r\n,\"mobile\":\"666999666\"\r\n,\"email\":\"inigo@ploints.com\"\r\n,\"postalcode\":28035\r\n,\"genderid\":1\r\n,\"birthdate\":\"1977-01-20T00:00:00.000Z\"\r\n,\"newpassword\":null\r\n,\"acceptcommercial\":true\r\n,\"acceptterms\":true\r\n  ,\"sociallogin\":{\"social\":\"facebook\"\r\n                 ,\"secret\":\"RGWERGWTGHWTH\"\r\n                 ,\"apikey\":\"wfwergwerghethe\"}\r\n}"
    },
    "UserToken" : {
      "type" : "string",
      "description" : "JSON Web Token (https://jwt.io/)\n\n{\n  \"alg\": \"HS256\",\n  \"typ\": \"JWT\"\n}\n\n{\n  \"sub\": \"inigo@ploints.com\",\n  \"name\": \"Iñigo\",\n  \"exp\": 1577833200,\n  \"userid\":\"00000000-0000-0000-0000-000000000000\",\n  \"usertype\":\"user\",\n\t\"baseURL\":\"https://virtserver.swaggerhub.com/Ploints/api/0.1.0\"\n}\n\nHMACSHA256(\n  base64UrlEncode(header) + \".\" +\n  base64UrlEncode(payload),\n  \"AC508B59-DB7F-4CFC-BAE5-A118E249D759\"\n)\n\n",
      "example" : "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJpbmlnb0BwbG9pbnRzLmNvbSIsIm5hbWUiOiJJw7FpZ28iLCJleHAiOjE1Nzc4MzMyMDAsInVzZXJpZCI6IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsInVzZXJ0eXBlIjoidXNlciIsImJhc2VVUkwiOiJodHRwczovL3ZpcnRzZXJ2ZXIuc3dhZ2dlcmh1Yi5jb20vUGxvaW50cy9hcGkvMC4xLjAifQ.894p0qs_1BRi84UgfDIPEuToEehxXLj_CFvgMwRHM_s"
    },
    "UserPoints" : {
      "type" : "object",
      "properties" : {
        "pointsname" : {
          "type" : "string"
        },
        "pointsavailable" : {
          "type" : "number"
        },
        "pointsavailablelocalcurrency" : {
          "type" : "number"
        },
        "pointsinpartners" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/UserPoints_pointsinpartners"
          }
        }
      },
      "description" : "User points and points partners detail",
      "example" : "{\r\n\t\"pointsname\":\"ploints\",\r\n\t\"pointsavailable\":78000,\r\n\t\"pointsavailablelocalcurrency\":43.65,\r\n\t\"pointsinpartners\":[\r\n\t\t{\"pointpartnerid\":\"b9ecbeb8-ecca-461d-9ae5-d960a71b4ad0\",\"pointpartnername\":\"Cabify\",\"points\":14000},\r\n\t\t{\"pointpartnerid\":\"b38738ee-8483-44eb-a5e5-8688b9b15dfd\",\"pointpartnername\":\"Air Europa\",\"points\":12000},\r\n\t\t{\"pointpartnerid\":\"17b1985c-631b-4af1-9d84-e5b6427175cc\",\"pointpartnername\":\"Yoigo\",\"points\":8000}\r\n\t\t]\r\n}"
    },
    "CardPartner" : {
      "type" : "object",
      "required" : [ "cardpartnercard", "cardpartnericon", "cardpartnerid", "cardpartnername" ],
      "properties" : {
        "cardpartnerid" : {
          "type" : "string"
        },
        "cardpartnername" : {
          "type" : "string"
        },
        "cardpartnericon" : {
          "type" : "string"
        },
        "cardpartnercard" : {
          "type" : "string"
        },
        "minvalue" : {
          "type" : "number"
        },
        "maxvalue" : {
          "type" : "number"
        },
        "allowedvalues" : {
          "type" : "array",
          "items" : {
            "type" : "number"
          }
        }
      },
      "example" : "{\n\t\"cardpartnerid\":\"7EE69445-5835-497F-B1FD-71982643F264\",\n\t\"cardpartnername\":\"Amazon\",\n\t\"cardpartnericon\":\"https://s3.amazonaws.com/com.ploints.firstbucket/content/images/amazon-logo.png\",\n\t\"cardpartnercard\":\"https://s3.amazonaws.com/com.ploints.firstbucket/content/images/amazon-gift-card.png\",\n\t\"minvalue\":0,\n\t\"maxvalue\":9999999,\n\t\"allowedvalues\":[50,100,250,500,1000]\n}"
    },
    "PointsPartner" : {
      "type" : "object",
      "properties" : {
        "pointspartnerid" : {
          "type" : "string"
        },
        "pointspartnername" : {
          "type" : "string"
        },
        "pointspartnericon" : {
          "type" : "string"
        },
        "connected" : {
          "type" : "string"
        },
        "type" : {
          "type" : "string"
        },
        "pointsinpartners" : {
          "type" : "number"
        },
        "pointpartnerurl" : {
          "type" : "string"
        }
      },
      "example" : "\r\n\t{\r\n\t\t\"pointspartnerid\":\"afe2d434-9351-465c-85ed-92cb6f9911ee\",\r\n\t\t\"pointspartnername\":\"Cabify\",\r\n\t\t\"pointspartnericon\":\"https://s3.amazonaws.com/com.ploints.firstbucket/content/images/cabify-logo.png\",\r\n\t\t\"connected\":\"yes\",\r\n\t\t\"type\":\"pull\",\r\n\t\t\"pointsinpartners\":14000,\r\n\t\t\"pointpartnerurl\":\"https://www.nh-hoteles.es/nhrewards\"\r\n\t}"
    },
    "User_sociallogin" : {
      "properties" : {
        "social" : {
          "type" : "string"
        },
        "secret" : {
          "type" : "string"
        },
        "apikey" : {
          "type" : "string"
        }
      }
    },
    "UserPoints_pointsinpartners" : {
      "properties" : {
        "pointpartnerid" : {
          "type" : "string"
        },
        "pointpartnername" : {
          "type" : "string"
        },
        "points" : {
          "type" : "number"
        }
      }
    }
  },
  "x-aws-api-id" : "40qbx5cb3l"
}